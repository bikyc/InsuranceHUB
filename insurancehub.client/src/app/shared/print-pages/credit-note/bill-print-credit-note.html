<!-- Set Page: A5, A4, A3 -->
<!-- Set Landscape or Portrait -->
<style>
  @page {
    size: A5 landscape;
    margin-top: 8px;
    margin-bottom: 10px;
    margin-left: 20px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    font-size: 12px;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  table td,
  table th {
    padding: 0;
    font-size: 10px;
  }

  .column {
    float: left;
    padding: 5px;
  }

  .box-body {
    padding: 0px 10px 0 10px;
  }

  .c_name {
    font-size: 12px !important;
    margin-bottom: 0;
    margin-top: 0;
  }

  .c_paragraphs {
    font-size: 10px !important;
    margin: 0 0 0 0;
    padding: 0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 30px;
  }

  table td,
  table th {
    text-align: left;
    vertical-align: top !important;
  }
</style>
<div class="A5 landscape" *ngIf="!PrintTemplateTypeSettings.Enable">
  <section class="sheet" id="divCreditNotePrintPage" *ngIf="isDataLoaded">
    <div class="box-body invoice header " style="color: #000; font-weight:600;">
      <table border="0" style="width: 100%; margin: 0 auto 5px auto; vertical-align: top !important" cellspacing="0"
             cellpadding="0">
        <tr *ngIf="InvoiceDisplaySettings.ShowHeader">
          <td colspan=" 6">
            <div>
              <billing-header *ngIf="InvoiceDisplaySettings.ShowHeader"
                              [show-qr-code]="ShowQRCode" [QRCodeInfo]=""
                              [header-type]="InvoiceDisplaySettings.HeaderType"></billing-header>
            </div>
          </td>
        </tr>
      </table>
      <table border="0" style="width: 100%; margin: 0 auto;" cellspacing="0" cellpadding="0">
        <tr>
          <td colspan="9" style="text-align: center;">
            <p><strong>CREDIT NOTE</strong></p>
          </td>
        </tr>
        <tr style="border: 1px solid #ccc;">
          <td colspan="9" style="padding: 6px !important;">
            <table class="patient-information" style="width: 100%; margin-bottom: 0; line-height: 1.2;">
              <tr>
                <td colspan="4" style="text-align: left;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Credit Note No:
                    <strong>{{ReturnInvoice.FiscalYear}}-CRN{{ReturnInvoice.CreditNoteNumber}}</strong>
                  </p>
                </td>
                <td colspan="4" style="text-align: right;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">CRN Date:<strong>{{ReturnInvoice.CreatedOn |
                      DanpheDateTime:'format':'YYYY-MM-DD'}}</strong> </p>
                </td>
              </tr>
              <tr>
                <td colspan="4" style="text-align: left;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Ref. Invoice No: <strong>{{ReturnInvoice.FiscalYear}} -
                      {{ReturnInvoice.InvoiceCode}}{{ ReturnInvoice.RefInvoiceNum}}</strong></p>
                </td>
                <td colspan="4" style="text-align: right;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;"> {{ReturnInvoice.CreatedOn |
                    nepaliDate:'format':'YYYY-MM-DD'}}</p>
                </td>
              </tr>
              <tr>
                <td colspan="4" style="text-align: left;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Hospital No : <strong>{{Patient.PatientCode}}</strong> </p>
                </td>
                <td colspan="4" style="text-align: right;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Ref.Invoice Date : <strong>{{ReferenceInvoiceDate |
                      DanpheDateTime:'format':'YYYY-MM-DD'}}</strong></p>
                </td>
              </tr>
              <tr>
                <td colspan="4" style="text-align: left;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Patient's Name: &nbsp;<strong>{{Patient.ShortName}}</strong></p>
                </td>
                <td colspan="4" style="text-align: right;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">{{ReturnInvoice.CreatedOn |
                    nepaliDate:'format':'YYYY-MM-DD'}}</p>
                </td>
              </tr>
              <tr>
                <td colspan="4" style="text-align: left;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Contact No: &nbsp;<strong>{{Patient.PhoneNumber}}</strong></p>
                </td>
                <td colspan="4" style="text-align: right;">
                  <p class="c_paragraphs" style="margin-bottom: 0px;">Age / Sex : <strong>{{Patient.Age }}/{{Patient.Gender}}</strong></p>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <th style="padding: 3px 5px !important; width: 5%">SN.</th>
          <th style="padding: 3px 5px !important; width: 5%">{{BillCustomLabels.HS_Code}}</th>
          <th colspan="5" style="padding: 3px 5px !important; width: 80%">Particular(s)</th>
          <th style="padding: 3px 5px !important; width: 5%">Unit</th>
          <th style="padding: 3px 5px !important; width: 5%">Amount</th>
        </tr>
        <tr *ngFor="let row of ReturnInvoice.ReturnInvoiceItems; let i=index">
          <td style="padding: 0 5px !important;  width: 5%">{{i+1}}.</td>
          <td style="padding: 0 5px !important;  width: 5%"></td>
          <td colspan="5" style="padding: 0 5px !important; width: 80%">{{row.ItemName}}</td>
          <td style="padding: 0 5px !important;  width: 5%">{{row.RetQuantity}}</td>
          <td style="padding: 0 5px !important;  width: 5%">{{row.RetTotalAmount}}</td>
        </tr>
        <tr style="border-top: 1px solid #ccc;">
          <td colspan="4" style="padding: 5px !important; vertical-align: top;">
            <p class="c_paragraphs" *ngIf="ReturnInvoice.TotalAmount !=0"><strong>In Words :{{ReturnInvoice.TotalAmount | number: "1.2-2" |
                NumberInWords | uppercase}} ONLY</strong></p>
          </td>
          <td colspan="4" style="padding: 5px !important; text-align: right;">
            <p class="c_paragraphs"><strong>Total Amount: </strong></p>
            <p class="c_paragraphs" *ngIf="ReturnInvoice.ReturnCashAmount > 0"><strong>Total Cash Return Amount: </strong></p>
          </td>
          <td colspan="3" style="padding: 5px !important;">
            <p class="c_paragraphs"> {{ReturnInvoice.TotalAmount | number : "1.2-2"}}</p>
            <p class="c_paragraphs" *ngIf="ReturnInvoice.ReturnCashAmount > 0"> {{ReturnInvoice.ReturnCashAmount | number: "1.2-2"}}</p>

          </td>
        </tr>
        <tr style="border-top: 1px solid #ccc;">
          <td colspan="4" style="padding: 5px !important; vertical-align: top;">
            <p class="c_paragraphs"><strong>User: </strong>{{BillReturnUserName}}</p>
          </td>
          <td colspan="4" style="padding: 5px !important; vertical-align: top; text-align: right;">
            <p class="c_paragraphs"><strong>Time: </strong> {{ReturnInvoice.CreatedOn |
              DanpheDateTime:'format':'hh:mm A'}}</p>
          </td>
        </tr>
        <tr>
          <td colspan="4" style="padding: 5px; vertical-align: top;">
            <p class="c_paragraphs"><strong>Remarks: </strong>{{ReturnInvoice.Remarks}}</p>
          </td>
          <td colspan="4" style="padding: 5px; vertical-align: top; text-align: right;">
          </td>
        </tr>
      </table>

    </div>
  </section>
</div>
<div style="text-align:center;z-index: 4;position: relative;margin-bottom: 25px; margin-top: 15px;" *ngIf="!PrintTemplateTypeSettings.Enable">
  <button class="btn green btn-success" value="" (click)="print()" id="btnPrintCreditNote" [disabled]="loading">
    <span>Print</span>&nbsp;&nbsp;
    &nbsp;&nbsp; <i class="glyphicon glyphicon-print"></i>
  </button>
</div>
<div id="id_dynamic_template_return_invoice_detail" *ngIf="PrintTemplateTypeSettings.Enable">
  <!--Here Dynamically the credit note will be rendered-->
</div>
<div style="text-align:center;z-index: 4;position: relative;margin-bottom: 25px; margin-top: 15px;" *ngIf="PrintTemplateTypeSettings.Enable">
  <button class="btn green btn-success" value="" (click)="PrintDynamicReceipt()" id="id_btn_print_dynamic_credit_note_receipt" [disabled]="loading">
    <span>Print Receipt</span>&nbsp;&nbsp;
    &nbsp;&nbsp; <i class="glyphicon glyphicon-print"></i>
  </button>
</div>

<select-printer [group-name]="'bill-receipt'" [storage-key]="'bil-creditnote'"
                (on-printer-change)="OnPrinterChanged($event)">
</select-printer>

<new-print-page *ngIf="openBrowserPrintWindow" [print-data]="browserPrintContentObj"
                (print-sucess)="AfterPrintCompleted()">
</new-print-page>